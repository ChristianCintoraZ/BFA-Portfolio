<!DOCTYPE html>
<html>
<head>
  <title>Christian Cintora Zavala</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script> <!-- p5.js library -->

  <style>
    body, h1, h2, h3, h4, h5, h6 {
      font-family: "Montserrat", sans-serif;
    }
    .w3-sidebar {
      width: 120px;
      background: #222;
    }
    #main {
      margin-left: 120px;
      position: relative;
    }
    @media only screen and (max-width: 600px) {
      #main {
        margin-left: 0;
      }
    }
    header.w3-container {
      padding-top: 100px;
    }

    /* Center the canvas container */
    .canvas-container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      opacity: 0; /* Start hidden */
      transition: opacity 1s ease-in-out; /* Fade effect */
      position: absolute;
      top: 0;
      left: 0;
      width: 100%; /* Full width */
      z-index: -1; /* Lower z-index so it doesn't cover other content */
      pointer-events: none;
    }
    .canvas-container.visible {
      opacity: 1;
      pointer-events: auto;
    }

    /* Ensure Portfolio link stays visible */
    header.w3-container p a {
      position: relative;
      z-index: 2; /* Raise z-index above the canvas */
      color: white;
      font-size: 24px;
      font-weight: bold;
    }

    /* Aligned Text Space Below the Canvas */
    .text-space {
      text-align: center;  /* Center the text */
      margin-top: 650px;    /* Space between canvas and text */
      font-size: 18px;     /* Adjust font size */
      color: #FFFFFF;      /* Text color */
    }
  </style>
</head>
<body class="w3-black">

<!-- Sidebar with buttons -->
<nav class="w3-sidebar w3-bar-block w3-small w3-hide-small w3-center">
  <a href="javascript:void(0);" class="w3-bar-item w3-button w3-padding-large w3-black" onclick="runOceanAmbiance()">
    <p style="font-size: 22px; font-weight: bold;">Ocean Amb</p>
  </a>
</a>
</nav>

<!-- Main Content -->
<div class="w3-padding-large" id="main">
  <header class="w3-container w3-padding-32 w3-center w3-black" id="home">
    <h1 class="w3-jumbo">Christian Cintora Zavala</h1>
    <p><a href="Portfolio.html">Go to Portfolio</a></p>
  </header>

  <!-- Canvas Container to Center the Canvas -->
  <div class="canvas-container" id="canvasContainer">
    <!-- Canvas will be placed here by p5.js -->
  </div>

  <!-- Aligned Text Space Below the Canvas -->
  <div class="text-space" id="textSpace">
    <p> Artist Statment<p>
    <p>This is a preview to my projects click and drag on screen to add more fish. <p>
  </div>
</div>

<!-- Boid Simulation Script -->
<script>
  let flock;
  let frameCount = 0;
  const colorChangeInterval = 600;

  function runOceanAmbiance() {
    const canvasContainer = document.getElementById('canvasContainer');
    canvasContainer.classList.add('visible');
    setup();
  }

  function setup() {
    let canvas = createCanvas(1200, 650);
    canvas.parent('canvasContainer');
    flock = new Flock();
    for (let i = 0; i < 100; i++) {
      let b = new Boid(width / 2, height / 2);
      flock.addBoid(b);
    }
    frameCount = 0;

          // canvas.mousePressed(() => {
          //   let b = new Boid(mouseX, mouseY);
          //   flock.addBoid(b);
          // });
        }
        function mouseDragged() {
  flock.addBoid(new Boid(mouseX, mouseY));
}
        function draw() {
          background(51, 51, 51, 50);
          let startColor, endColor;

          if (frameCount < colorChangeInterval) {
            startColor = color(0, 0, 255);
            endColor = color(0, 255, 0);
          } else if (frameCount < colorChangeInterval * 2) {
            startColor = color(0, 255, 0);
            endColor = color(0, 0, 255);
          } else {
            startColor = color(0, 0, 255);
            endColor = color(0, 255, 0);
            frameCount = 0;
          }

          let lerpedColor = lerpColor(startColor, endColor, (frameCount % colorChangeInterval) / colorChangeInterval);
          flock.setBoidColor(lerpedColor);

          flock.run();
          frameCount++;
        }

        class Flock {
          constructor() {
            this.boids = [];
          }
          run() {
            for (let boid of this.boids) {
              boid.run(this.boids);
            }
          }
          addBoid(b) {
            this.boids.push(b);
          }
          setBoidColor(color) {
            for (let boid of this.boids) {
              boid.boidColor = color;
            }
          }
        }

        class Boid {
          constructor(x, y) {
            this.position = createVector(x, y);
            this.velocity = p5.Vector.random2D();
            this.velocity.setMag(random(2, 4));
            this.acceleration = createVector();
            this.boidColor = color(255);
            this.maxForce = 0.05;
            this.maxSpeed = 3;
            this.trail = [];
            this.trailLength = 10;
          }

          run(boids) {
            this.flock(boids);
            this.update();
            this.borders();
            this.render();
          }

          applyForce(force) {
            this.acceleration.add(force);
          }

          flock(boids) {
            let separation = this.separate(boids);
            let alignment = this.align(boids);
            let cohesion = this.cohesion(boids);
            separation.mult(1.5);
            alignment.mult(1.0);
            cohesion.mult(1.0);
            this.applyForce(separation);
            this.applyForce(alignment);
            this.applyForce(cohesion);
          }

          update() {
            this.velocity.add(this.acceleration);
            this.velocity.limit(this.maxSpeed);
            this.position.add(this.velocity);
            this.acceleration.mult(0);

            this.trail.push(this.position.copy());
            if (this.trail.length > this.trailLength) {
              this.trail.shift();
            }
          }

          borders() {
            if (this.position.x < 0) this.position.x = width;
            if (this.position.y < 0) this.position.y = height;
            if (this.position.x > width) this.position.x = 0;
            if (this.position.y > height) this.position.y = 0;
          }

          render() {
            noStroke();
            for (let i = 0; i < this.trail.length; i++) {
              let alpha = map(i, 0, this.trail.length, 0, 255);
              fill(this.boidColor.levels[0], this.boidColor.levels[1], this.boidColor.levels[2], alpha);
              let pos = this.trail[i];
              ellipse(pos.x, pos.y, 6, 6);
              ellipse(pos.x, pos.y, 6, 24);
            }
            fill(this.boidColor);
            ellipse(this.position.x, this.position.y, 8, 8);
          }

          separate(boids) {
            let desiredSeparation = 25;
            let steer = createVector();
            let count = 0;
            for (let other of boids) {
              let d = p5.Vector.dist(this.position, other.position);
              if (d > 0 && d < desiredSeparation) {
                let diff = p5.Vector.sub(this.position, other.position);
                diff.normalize();
                diff.div(d);
                steer.add(diff);
                count++;
              }
            }
            if (count > 0) {
              steer.div(count);
            }
            if (steer.mag() > 0) {
              steer.setMag(this.maxSpeed);
              steer.sub(this.velocity);
              steer.limit(this.maxForce);
            }
            return steer;
          }

          align(boids) {
            let neighborDist = 50;
            let sum = createVector();
            let count = 0;
            for (let other of boids) {
              let d = p5.Vector.dist(this.position, other.position);
              if (d > 0 && d < neighborDist) {
                sum.add(other.velocity);
                count++;
              }
            }
            if (count > 0) {
              sum.div(count);
              sum.setMag(this.maxSpeed);
              let steer = p5.Vector.sub(sum, this.velocity);
              steer.limit(this.maxForce);
              return steer;
            } else {
              return createVector();
            }
          }

          cohesion(boids) {
            let neighborDist = 50;
            let sum = createVector();
            let count = 0;
            for (let other of boids) {
              let d = p5.Vector.dist(this.position, other.position);
              if (d > 0 && d < neighborDist) {
                sum.add(other.position);
                count++;
              }
            }
            if (count > 0) {
              sum.div(count);
              return this.seek(sum);
            } else {
              return createVector();
            }
          }

          seek(target) {
            let desired = p5.Vector.sub(target, this.position);
            desired.setMag(this.maxSpeed);
            let steer = p5.Vector.sub(desired, this.velocity);
            steer.limit(this.maxForce);
            return steer;
          }
        } 
</script>
</body>
</html>
